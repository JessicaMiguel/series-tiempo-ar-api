---

- import_playbook: api_cluster.yml
- import_playbook: redis.yml
- import_playbook: elasticsearch.yml

- hosts: web
  become: yes
  become_method: sudo
  roles:
    - basic_server
    - { role: maintenance, maintenance_on: yes }
    - postgresql

# Use non-root user
- hosts: web
  become: yes
  become_method: sudo
  become_user: "{{ application_user }}"
  roles:
    - django_application

- hosts: web
  become: yes
  become_method: sudo
  roles:
    - web_server
    - { role: maintenance, maintenance_off: yes }


